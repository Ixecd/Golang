## Golang

# 发展史
- Go 1.5自举(使用Go语言编写程序来实现Go语言本身)
- Go 1.7急速GC(垃圾回收器)
- Go 1.10对自带工具的全面升级,使用`go mod`来做程序依赖管理

# 环境变量
- `go env`
- GOROOT: Go语言安装根目录的路径,也就是Go语言的安装路径
- GOPATH: 若干工作区目录的路径,我们自己定义的工作空间
- GOBIN: Go程序生成的可执行文件的路径
1. 设置GOPATH的意义?
    - 可以将GOPATH简单理解成GO语言的工作目录,值是**一个目录的路径,也可以是多个目录路径**,每个目录都代表Go语言的一个工作区(workspace)
    - 利用这些工作区,放置Go语言的源码文件,以及安装后的归档文件(archive file,也就是以".a"为扩展名的文件)和可执行文件
    - Go语言项目在其生命周期内的所有操作(编码/依赖管理/构建/测试/安装等)基本上都是围绕GOPATH和工作区进行的
2. Go语言源码的组织方式
    - 以代码包作为基本单位组织,**代码包其实与目录一一对应**,代码包也可以有子包
    - 一个代码包中可以包含任意个.go为扩展名的源码文件,这些源码文件都需要被声名属于同一个代码包
    - 代码包的名称一般会与源码文件所在的目录同名,如果不同名,在构建/安装的过程中会以代码包名称为准
    - 每个代码包都有导入路径,代码包的导入路径是其他代码在使用该包中的程序实体时,需要引入的路径`import "github.com/labstack/echo"`
    - 一个代码包的导入路径实际上就是**从src子目录**,到该包的实际存储位置的相对路径
3. 源码安装后的结果
    - 源码文件通常会被放在某个工作区的src子目录下
    - 安装之后如果出现归档文件(.a为扩展名的文件),则会被放置在$GOPATH/pkg子目录下
    - 如果安装后出现可执行文件,则会被放置在该工作区的bin子目录下
    - **某个工作区的src子目录下的源码文件,安装之后会一般放置在当前工作区的pkg子目录下对应的目录中,或者被直接放置到该工作区的bin子目录下**
4. 理解构建和安装Go程序过程
- 构建使用命令`go build`,安装使用命令`go install`
- 构建和安装代码包的时候都会执行编译/打包等操作,这些操作生成的任何文件都会被保存到某个临时的目录中
- 如果构建的是库源码文件,那么操作后产生的结构文件只会存在于临时目录中,这里的构建的主要意义在于检查和验证
- 如果构建的是命令源码文件,那么操作的结构文件会被搬运到源码文件所在的目录中
- 安装操作会先执行构建,然后还会进行链接操作,并且把结构文件搬运到指定目录
- **如果安装的是库源码文件**,那么结果文件会搬运到它所在工作区的pkg目录下的某个子目录中
- **如果安装的是命令源码文件**,那么结果文件会被搬运到它所在工作区的bin目录下,或者环境变量GOBIN指定的目录下

# 命令源码文件(可执行文件)
- **如果一个源码文件生命属于main包,并且包含一个无参数声明其无结果的main函数,那么它就是命令源码文件**
- 命令源码文件一般会被编译为可执行文件,这个可执行文件可以直接运行,也可以被其他程序调用
- **命令源码文件永远只会也只能有一个,如果有与命令源码文件同包的源码文件,那么他们也应该声明属于main包**

# 命令源码文件怎样接收参数
- Go语言标准库中有一个代码包专门用于接收和解析命令参数,这个代码包是`flag`
- `flag.StringVar(&, "", "", "")`
- flag.StringVar接收4个参数
    - 第一个参数是接收变量的地址
    - 第二个参数是为了指定该命令参数的名称,如果不指定,则会使用第一个参数的变量名
    - 第三个参数是该命令参数的默认值
    - 第四个参数是该命令参数的描述信息
- 还有一个类似的函数`flag.String()`,这个直接返回一个已经分配好的用于存储命令参数指的地址
- 使用的方法如下
    - `var name = flag.String("name", "everyone", "The greeting object"))`

# 怎样在运行命令源码文件的时候传入参数,又则哪有那个查看参数的使用说明
- 以上面的`helloworld.go`为例
- `go run helloWorld.go -name="Go"`,**等号右边不能有空格**
- 查看你命令源码文件的参数说明
- `go run helloWorld.go -h`
- 命令产生的第一行 /tmp/go-build... 其实是go run命令构建上述命令源码文件是临时生成的可执行文件的完整路径
- 如果使用`go build helloWorld.go`
- 之后会在同级目录下生成一个可执行文件`helloWorld`
- 执行`./helloWorld --help`,会发现Usage of ./helloWorld

# 怎样自定义命令源码文件的参数使用说明
- 最简单的一种方式就是对变量`flag.Usage`重新赋值,`flag.Usage`的类型是`func()`,也就是一个无参数无结果声明的函数类型
- `flag.Usage`的赋值必须在调用`flag.Parse`函数之前

**更深一步**
- 我们调用`flag`包中的一些函数(StringVar, Parse等)的时候,其实就是在调用`flag,CommandLine`变量的对应方法
- `flag.CommandLine`相当于默认情况下的命令参数容器,所以,通过对flag.CommandLine重新赋值,就可以更深层次的定制当前命令源码文件的参数使用说明